<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: App.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: App.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useContext, useEffect, useState } from 'react'
import { BrowserRouter } from 'react-router-dom'
import AppRouter from './components/AppRouter'
import NavBar from './components/nav/NavBar'
import Footer from './components/footer/Footer'
import { observer } from 'mobx-react-lite'
import { Context } from './index'
import { check } from './http/userAPI'
import { Spinner } from 'react-bootstrap'
import CookieConsent from 'react-cookie-consent'

/**
 * Головний компонент додатку.
 * Відповідає за відображення основних елементів UI:
 * - навігаційного меню (NavBar)
 * - маршрутизації сторінок (AppRouter)
 * - підвалу сайту (Footer)
 * - обробки авторизації користувача
 * - управління cookie-згодою
 */
const App = observer(() => {
	const { user } = useContext(Context)
	const [loading, setLoading] = useState(true) // Стан завантаження при перевірці авторизації
	const [cookieAccepted, setCookieAccepted] = useState(() => {
		const storedConsent = localStorage.getItem('cookieConsent')
		return storedConsent === 'true'
	})

	// Виконується один раз при завантаженні сторінки
	useEffect(() => {
		check()
			.then(data => {
				user.setUser(data) // Встановлюємо дані користувача
				user.setIsAuth(true) // Позначаємо, що користувач авторизований
			})
			.catch(() => {
				localStorage.removeItem('token') // Якщо помилка, видаляємо токен
				user.setUser({}) // Скидаємо дані користувача
				user.setIsAuth(false) // Позначаємо, що користувач не авторизований
			})
			.finally(() => setLoading(false)) // Завершуємо завантаження
	}, [])

	// Функція для прийняття cookies
	const handleAcceptCookies = () => {
		localStorage.setItem('cookieConsent', 'true')
		setCookieAccepted(true)
	}

	// Функція для відхилення cookies
	const handleDeclineCookies = () => {
		localStorage.setItem('cookieConsent', 'false')
		document.cookie =
			'cookieConsent=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;'
		setCookieAccepted(false)
	}

	// Якщо додаток ще завантажується – показуємо спінер
	if (loading) {
		return &lt;Spinner animation={'grow'} />
	}

	return (
		&lt;BrowserRouter>
			&lt;NavBar />
			&lt;AppRouter />

			{/* Спливаюче вікно для згоди з використанням cookies */}
			{!cookieAccepted &amp;&amp; (
				&lt;CookieConsent
					location='bottom'
					buttonText='Прийняти'
					declineButtonText='Відмовитись'
					enableDeclineButton
					onAccept={handleAcceptCookies}
					onDecline={handleDeclineCookies}
					cookieName='cookieConsent'
					expires={365}
					style={{ background: '#000', color: '#fff' }}
					buttonStyle={{
						background: '#fff',
						color: '#000',
						fontSize: '14px',
						border: '1px solid #fff',
					}}
					declineButtonStyle={{
						background: 'transparent',
						color: '#fff',
						fontSize: '14px',
						border: '1px solid #fff',
					}}
				>
					Ми використовуємо cookies для покращення досвіду на сайті.{' '}
					&lt;a
						href='/privacy-policy'
						style={{ color: '#fff', textDecoration: 'underline' }}
					>
						Дізнатися більше
					&lt;/a>
				&lt;/CookieConsent>
			)}

			&lt;Footer />
		&lt;/BrowserRouter>
	)
})

export default App
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#Auth">Auth</a></li><li><a href="global.html#BrandBar">BrandBar</a></li><li><a href="global.html#NavBar">NavBar</a></li><li><a href="global.html#Pages">Pages</a></li><li><a href="global.html#ProductList">ProductList</a></li><li><a href="global.html#ProductPage">ProductPage</a></li><li><a href="global.html#Shop">Shop</a></li><li><a href="global.html#TypeBar">TypeBar</a></li><li><a href="global.html#check">check</a></li><li><a href="global.html#deleteAccount">deleteAccount</a></li><li><a href="global.html#exportData">exportData</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#registration">registration</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Feb 28 2025 01:03:03 GMT+0200 (за східноєвропейським стандартним часом)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
