<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: http/userAPI.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: http/userAPI.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { $authHost, $host } from './index'
import { jwtDecode } from 'jwt-decode'

/**
 * Реєстрація користувача.
 * Відправляє email та пароль на сервер для створення нового акаунта.
 * Сервер повертає токен, який зберігається в localStorage та розшифровується.
 * @param {string} email - Email користувача
 * @param {string} password - Пароль користувача
 * @returns {object} - Декодований токен користувача
 */
export const registration = async (email, password) => {
	const { data } = await $host.post('api/user/registration', {
		email,
		password,
		role: 'ADMIN', // За замовчуванням створюється адміністратор
	})
	localStorage.setItem('token', data.token) // Зберігаємо токен у localStorage
	return jwtDecode(data.token) // Декодуємо та повертаємо токен
}

/**
 * Авторизація користувача.
 * Відправляє email і пароль на сервер. Якщо успішно, сервер повертає токен.
 * @param {string} email - Email користувача
 * @param {string} password - Пароль користувача
 * @returns {object} - Декодований токен користувача
 */
export const login = async (email, password) => {
	const { data } = await $host.post('api/user/login', { email, password })
	localStorage.setItem('token', data.token) // Зберігаємо токен у localStorage
	return jwtDecode(data.token) // Декодуємо та повертаємо токен
}

/**
 * Перевірка авторизації.
 * Надсилає запит до сервера для перевірки, чи дійсний токен.
 * Якщо токен ще актуальний, оновлює його в localStorage.
 * Якщо ні, видаляє токен та викидає помилку.
 * @returns {object} - Декодований токен користувача або помилка
 */
export const check = async () => {
	try {
		const { data } = await $authHost.get('api/user/auth') // Запит на перевірку токена
		localStorage.setItem('token', data.token) // Оновлюємо токен
		return jwtDecode(data.token) // Декодуємо та повертаємо токен
	} catch (e) {
		localStorage.removeItem('token') // Якщо токен недійсний, видаляємо його
		throw e // Викидаємо помилку для обробки
	}
}

/**
 * Видалення акаунта користувача.
 * Надсилає запит на сервер для видалення акаунта.
 * @returns {object} - Відповідь сервера
 */
export const deleteAccount = async () => {
	const response = await $authHost.delete('/api/user/delete')
	return response.data
}

/**
 * Експорт даних користувача.
 * Отримує експортовані дані користувача із сервера.
 * @returns {object} - Дані користувача у форматі, який визначає сервер
 */
export const exportData = async () => {
	const response = await $authHost.get('/api/user/export')
	return response.data
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#App">App</a></li><li><a href="global.html#Auth">Auth</a></li><li><a href="global.html#BrandBar">BrandBar</a></li><li><a href="global.html#NavBar">NavBar</a></li><li><a href="global.html#Pages">Pages</a></li><li><a href="global.html#ProductList">ProductList</a></li><li><a href="global.html#ProductPage">ProductPage</a></li><li><a href="global.html#Shop">Shop</a></li><li><a href="global.html#TypeBar">TypeBar</a></li><li><a href="global.html#check">check</a></li><li><a href="global.html#deleteAccount">deleteAccount</a></li><li><a href="global.html#exportData">exportData</a></li><li><a href="global.html#login">login</a></li><li><a href="global.html#registration">registration</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Feb 28 2025 01:03:03 GMT+0200 (за східноєвропейським стандартним часом)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
